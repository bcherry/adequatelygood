(function(j){var l;var k;var a;var i=function(){l.dialog("destroy");delete l;delete k;a=null};var n=function(){i();consul.log("dialog closed")};var b=function(){consul.log("dialog opened")};var e=function(p,r,o){var q={"400":"Uh oh!  I couldn't save your comment.  Luckily, it doesn't look like you're a spam bot, you just forgot a required field or something.","401":"Hmmmm, you're a suspicious character.  If you're human, try entering the captcha again.  If you're a robot, then we've got issues."};if(!(p.status in q)){q[p.status]="Ooops!  There was a mysterious error of some kind.  Sorry about that!  ("+p.status+" - "+p.statusText+")"}k.errorText.text(q[p.status]);k.error.show()};var d=function(p){j("#num_comments").text(parseInt(j("#num_comments").text(),10)+1);var o=a.split("#")[1];if(o==""){j("#commentslist").prepend(p)}else{j("#"+o).after(p)}f()};var g={cache:false,dataType:"html",error:e,success:d,type:"POST"};var h=function(){consul.log("comment submission begun, submitting to %s",a);k.error.hide();var o=g;o.url=a;o.data={key:a,captcha:j(k.captcha).val(),name:j(k.commentName).val(),email:j(k.commentEmail).val(),title:j(k.commentTitle).val(),body:j(k.commentBody).val()};j.ajax(o)};var f=function(){l.dialog("close");i()};var m={autoOpen:false,modal:true,title:"leave a comment!",width:500,close:n,open:b,buttons:{"leave comment":h,cancel:f}};var c=function(){l=j("<div/>");k=l.tmpl("_tmpl_commentDialog",{});l.dialog(m);a=j(this).get(0).href;l.dialog("open");return false};j(function(){j(".replybtn").live("click",c)})})(jQuery);